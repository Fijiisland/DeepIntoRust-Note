# 堆和栈

一个进程执行时，在所占用的内存虚拟地址空间中被分割成好几个段segment：

- 代码段：编译后的机器码存放处
- bss段：存放未初始化的全局变量和静态变量
- 数据段：存放已初始化的全局变量和静态变量
- 函数调用栈：存放函数参数、局部变量以及函数调用相关的区域
- 堆：存放动态分配内存的区域

特别地，堆是为动态分配预留的内存空间，在堆上分配内存无固定模式，使得追踪与释放较复杂。每个线程都有一个栈，但每个应用程序通常只有一个堆，在之上的变量必须手动释放。

堆和栈的主要区别：

- 栈上保存的局部变量在离开当前作用域自动释放
- 堆分配的变量无作用域，需手动释放
- 栈上分配的空间大小一般在编译期可确定
- 栈有一个最大长度，超过会造成stack overflow
- 堆空间大于栈，若堆内存耗尽会造成out of memory